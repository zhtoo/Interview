### 基本原理

两个关键类：view  和  ViewGroup 

三个关键方法：
- onMeasure()
- onLayout()
- onDraw()

View的绘制基本上由measure()、layout()、draw() 完成

### 基本步骤

1、测量：测量过程会涉及以下方法

    public final void measure(int widthMeasureSpec, int heightMeasureSpec) 
	protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) 
    protected final void setMeasuredDimension(int measuredWidth, int measuredHeight)  
    
调用顺序：measure()--->onMeasure() ---> setMeasureDimension()。

其中onMeasure()负责测量宽度、高度； setMeasureDimension()负责保存测量结果。在view的子类中重写onMeasure()（PS：ViewGroup也是view的子类） 

PS：关于数据的初始化问题：与控件宽高相关的数据可以在onMeasure()进行，当然复杂的逻辑计算需要慎重，16ms原则（android屏幕刷新的频率是60帧每秒(fps)，约等于每16.6ms刷新一下）。

#### 补充：MeasureSpec三个常量：

- UNSPECIFIED：父控件没有对子控件施加任何约束。子控件可以是它想要的任何尺寸。
- EXACTLY：父控件已确定子控件的确切大小。 无论子控件想要多大，子控件都会得到这些界限。
- AT_MOST：子控件可以达到指定大小所需的大小。
 
onMeasure（）的参数是int类型的数据。实际上这个数据包含两个信息：高两位表示测量模式，剩下的30为数据表示控件的宽/高的具体数值

最高两位是00：MeasureSpec.UNSPECIFIED（未指定模式）
最高两位是01：MeasureSpec.EXACTLY（精确模式）
最高两位是10：MeasureSpec.AT_MOST（最大模式）

源码如下：

 	private static final int MODE_SHIFT = 30;
	private static final int MODE_MASK  = 0x3 << MODE_SHIFT;  
    public static final int UNSPECIFIED = 0 << MODE_SHIFT;
    public static final int EXACTLY = 1 << MODE_SHIFT;
    public static final int AT_MOST = 2 << MODE_SHIFT;

对应的字节：

- MODE_MASK:   11000000000000000000000000000000
- UNSPECIFIED: 00000000000000000000000000000000
- EXACTLY: 01000000000000000000000000000000
- AT_MOST: 10000000000000000000000000000000

UNSPECIFIED、AT_MOST、EXACTLY这三种模式对应xml不同的状态做解释：

一个控件的宽高值：match_parent、wrap_content和具体的数值（dp/px）

UNSPECIFIED 对应的情况：
官方解释：父控件没有对子控件施加任何约束。子控件可以是它想要的任何尺寸。
 

//每一个控件对应的有LayoutParams

https://blog.csdn.net/itheimach/article/details/52295699

2、布局（存在于ViewGroup）

3、绘制